<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="A.laldin" />


<title>About</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-id-card"></span>
     
    CV
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-briefcase"></span>
     
    Portfolio
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Sports</li>
    <li>
      <a href="page-a.html">Cricket</a>
    </li>
    <li>
      <a href="page-b.html">CSGO</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Biology</li>
    <li>
      <a href="mm.html">Mismatch Distributions</a>
    </li>
    <li>
      <a href="page-d.html">Page D</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://example.com">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">About</h1>
<h4 class="author"><em>A.laldin</em></h4>
<h4 class="date"><em>9 April 2019</em></h4>

</div>


<div id="introduction-and-preface" class="section level2">
<h2><a href="sheading-2">Introduction and Preface</a></h2>
<p>For all of DnaSP’s wonderful functionality its visualisations leave much to be desired. You may be tempted to use MS Excel. While Excel is effective for many tasks it is limited in its functionality. Last time I checked, Excel cannot handle more than 239 data points when creating a scatter-plot and secondly, moving data from DnaSP’s.out format into Excel is tedious at best. However, this can be circumvented in a few short steps with a little bit of code.</p>
<p>This tutorial is targeted towards biologists/ecologists/population geneticists who have a very basic understanding of R but a strong background in population genetics,( otherwise I don’t know why you’d be calculating pairwise mismatch distributions;) ).</p>
<p>If you already have an idea of what you are doing, feel free to download the R script from here and use it. If you need a little bit of additional help and a walk through of the required steps. Keep reading.</p>
<p>Provided that you already have your data generated from DnaSP you will undertake</p>
<div id="four-steps" class="section level3">
<h3><a href="sheading-2">Four Steps:</a></h3>
<ol style="list-style-type: decimal">
<li>Reading the .out file into R</li>
<li>Cleaning and formatting the data</li>
<li>Plotting the results to publication quality level</li>
<li>Having a congratulatory beer (Optional)</li>
</ol>
<div id="functions-used" class="section level4">
<h4><a href="sheading-2">Functions Used:</a></h4>
<p>We will use :</p>
<ol style="list-style-type: decimal">
<li>One base R function to read in the data</li>
<li>One tidyr function to clean data (Step 2 will not be used in the method #1)</li>
<li>Two ggplot2 functions to plot data and save the resulting plot</li>
</ol>
</div>
</div>
</div>
<div id="method-1" class="section level2">
<h2><a href="sheading-2">Method 1</a></h2>
<div id="libraries-used" class="section level4">
<h4><a href="sheading-2">Libraries Used</a></h4>
<pre class="r"><code>library(tidyr)   # For tidying data
library(ggplot2) # For plotting data
library(bbplot) # For plot layout 
library(ggthemes) # Applying theme </code></pre>
</div>
<div id="note-regarding-setting-working-directory" class="section level3">
<h3>Note Regarding Setting Working Directory</h3>
<p>Generally speaking, it is best not to use the <code>setwd(&quot;C:/Me/Myfiles&quot;)</code> to alter the working directory. It is better to target the read function directly to the location of the file as will be seen below.</p>
</div>
<div id="read-in-file-from-dnasp" class="section level3">
<h3><a href="sheading-2">Read in file from DnaSP</a></h3>
<p>Arguments <em>skip</em> and <em>col.names</em> have been used to</p>
<ol style="list-style-type: decimal">
<li>Skip unnecessary data located in file</li>
<li>Clean Messy Column Names</li>
</ol>
<pre class="r"><code>MM &lt;- read.table(&quot;C:/Users/the_siff/Desktop/RR/DataScience/new.out&quot;,
  skip = 43,
  col.names = c(&quot;Differences&quot;, &quot;FreqObs&quot;, &quot;FreqExp&quot;)
)</code></pre>
<p>Above you can see the first argument of the <code>read.table()</code> function is directed to the exact location where the file is stored. After that two optional arguments are used which are integral to the process of reading in this.out file: <code>Skip</code>, ensures the function does not read the data preceding the first 43 lines <code>col.names</code>, assigns a new set of column names via a character vector</p>
<pre class="r"><code>head(MM)%&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Differences</th>
<th align="right">FreqObs</th>
<th align="right">FreqExp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0.20000</td>
<td align="right">0.06818</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0.20000</td>
<td align="right">0.06353</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0.00000</td>
<td align="right">0.05920</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">0.00000</td>
<td align="right">0.05516</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">0.06667</td>
<td align="right">0.05140</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">0.00000</td>
<td align="right">0.04790</td>
</tr>
</tbody>
</table>
<p>We can call up the head of the data and see that the file has been read in correctly and the file names are just as we specified.</p>
</div>
<div id="ggplot2-fundementals" class="section level3">
<h3><a href="sheading-2">ggplot2 fundementals</a></h3>
<p>If you are not familiar with <code>ggplot2</code> this may look a little complicated, but you will soon find that it really isn’t. In a nutshell <code>ggplot2</code> plots (based on the grammar of graphics) are built in “layers”, each time you see +, the proceeding code is an additional <code>&quot;layer&quot;</code>.</p>
<p>We first call the data set in question <strong>(MM)</strong>, containing our mismatch data. then set the variables to appear on <strong>X(Differences)</strong> and <strong>Y(FreqObs)</strong> axis and define the type of <code>geom</code>(type of plot) we want. In this case a we want a line plot thus we use <code>geom_line()</code>. The linetype arguments alters the type of line produced on the plot. Have a play with values 1-5 and see what you get(Value 1 is the default, i.e. if you left that argument blank it would automatically choose 1).</p>
<p>As we are viewing two lines, observed and expected frequency values, an additional <code>geom_line()</code> with another <code>Y(FreqExp)</code>call is used to plot the variable not used in the first call. Here the col argument allows you to change the colour of the line by naming the colour or using a hex colour code(this argument can also be applied to the <code>geom_line()</code>. Here is a great site for selecting colour codes and palettes. After that we have two more layers: The theme is personal preference and the labs function adds labels to the plots.</p>
</div>
<div id="plotting-method1" class="section level3">
<h3><a href="sheading-2">Plotting Method1</a></h3>
<pre class="r"><code>ggplot(MM, aes(
  x = Differences, 
  y = FreqObs)) +
  geom_line(linetype = 1) +
  geom_line(aes(y = FreqExp), col=&quot;red&quot;)+
  labs(
    subtitle = &quot;Species X&quot;,
    title = &quot; DNA Mismatch Distribution &quot;,
    caption = &quot;Using Publically Available Data&quot;,
    x = &quot;Differences&quot;,
    y = &quot;Frequency Observed&quot;)+
  theme_fivethirtyeight() </code></pre>
<p><img src="mm_files/figure-html/Plotting%201-1.png" width="672" /></p>
</div>
<div id="saving-plot-using-ggsave" class="section level3">
<h3><a href="sheading-2">Saving Plot Using <code>ggsave</code></a></h3>
<pre class="r"><code>ggsave(
  filename = &quot;C:/Users/the_siff/Desktop/RR/DataScience/MyMM1.jpeg&quot;,
  dpi = 600, type = &quot;cairo&quot;,
  height = 2.71,
  width  = 2.32,
  units = &quot;in&quot;
)</code></pre>
<p>A ggsave call will save the most recently produced ggplot2 plot within your R console(use it carefully). The type argument is useful if you are using R on windows due to anti-aliasing issues, which result in very jagged lined plots. The dimensions arguments are optional and can be left blank/default.</p>
</div>
</div>
<div id="method-2" class="section level2">
<h2><a href="sheading-2">Method 2</a></h2>
<div id="formatting-data-into-the-correct-tidy-format" class="section level3">
<h3><a href="sheading-2">Formatting Data into the correct TIDY format</a></h3>
<p><strong>Frequency</strong> column will take both sets of frequency calls and <strong>type</strong> will contain expected and observed values</p>
<pre class="r"><code>TidyMM &lt;- gather(MM,
  value = &quot;Frequency&quot;,
  key = &quot;Type&quot;,
  FreqObs, FreqExp
)</code></pre>
<p>The gather function is native to tidyr, a component of the tidyverse family. Frequency column will take both sets of frequency calls and type will contain FreqExp and FreqObs values.</p>
</div>
<div id="comparing-formats" class="section level3">
<h3><a href="sheading-2">Comparing Formats</a></h3>
<pre class="r"><code>head(MM)%&gt;% knitr::kable()     # Original</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Differences</th>
<th align="right">FreqObs</th>
<th align="right">FreqExp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0.20000</td>
<td align="right">0.06818</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0.20000</td>
<td align="right">0.06353</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0.00000</td>
<td align="right">0.05920</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">0.00000</td>
<td align="right">0.05516</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">0.06667</td>
<td align="right">0.05140</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">0.00000</td>
<td align="right">0.04790</td>
</tr>
</tbody>
</table>
<pre class="r"><code>head(TidyMM) %&gt;% knitr::kable() # Altered head</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Differences</th>
<th align="left">Type</th>
<th align="right">Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="left">FreqObs</td>
<td align="right">0.20000</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">FreqObs</td>
<td align="right">0.20000</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">FreqObs</td>
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">FreqObs</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">FreqObs</td>
<td align="right">0.06667</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">FreqObs</td>
<td align="right">0.00000</td>
</tr>
</tbody>
</table>
<pre class="r"><code>tail(TidyMM) %&gt;% knitr::kable() # Altered tail</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Differences</th>
<th align="left">Type</th>
<th align="right">Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>71</td>
<td align="right">32</td>
<td align="left">FreqExp</td>
<td align="right">0.00712</td>
</tr>
<tr class="even">
<td>72</td>
<td align="right">33</td>
<td align="left">FreqExp</td>
<td align="right">0.00663</td>
</tr>
<tr class="odd">
<td>73</td>
<td align="right">34</td>
<td align="left">FreqExp</td>
<td align="right">0.00618</td>
</tr>
<tr class="even">
<td>74</td>
<td align="right">35</td>
<td align="left">FreqExp</td>
<td align="right">0.00576</td>
</tr>
<tr class="odd">
<td>75</td>
<td align="right">36</td>
<td align="left">FreqExp</td>
<td align="right">0.00537</td>
</tr>
<tr class="even">
<td>76</td>
<td align="right">37</td>
<td align="left">FreqExp</td>
<td align="right">0.00500</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-method-2" class="section level3">
<h3><a href="sheading-2">Plotting Method 2</a></h3>
<pre class="r"><code>ggplot(TidyMM, aes(
  x = Differences, 
  y = Frequency, 
  linetype = Type)) +
  geom_line(show.legend = FALSE) +
  theme_minimal() +
  labs(
    subtitle = &quot;Species X&quot;,
    title = &quot; DNA Mismatch Distribution &quot;,
    caption = &quot;Using Publically Available Data&quot;,
    x = &quot;Differences&quot;,
    y = &quot;Frequency Observed&quot;)+
  theme_fivethirtyeight()</code></pre>
<p><img src="mm_files/figure-html/Plotting%20Data%202-1.png" width="672" /></p>
</div>
<div id="saving-plot-using-ggsave-1" class="section level3">
<h3><a href="sheading-2">Saving Plot Using <code>ggsave</code></a></h3>
<pre class="r"><code>ggsave(
  filename = &quot;C:/Users/the_siff/Desktop/RR/DataScience/MyMM2.jpeg&quot;,
  dpi = 600, type = &quot;cairo&quot;,
  height = 2.71,
  width  = 2.32,
  units = &quot;in&quot;
)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
